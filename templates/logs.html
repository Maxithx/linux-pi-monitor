{% extends "base.html" %}
{% block title %}Logs{% endblock %}
{% block page_title %}Logs{% endblock %}

{% block content %}
<h1 style="margin-bottom: 20px;">System Log (Flask Server)</h1>

<!-- CSS links -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/logs.css') }}">

<div class="container">
    <!-- Top buttons -->
    <div class="logs-header" style="display: flex; gap: 10px; flex-wrap: wrap; align-items: center;">
        <a href="{{ url_for('dashboard_bp.dashboard') }}" class="button-link">‚Üê Back to Dashboard</a>
        <form onsubmit="openLogFile(); return false;">
            <button type="submit" class="button-link">üìÑ Open full log file in Notepad</button>
        </form>
    </div>

    <!-- Log content -->
    <div class="logs-container">
        <ul id="logs-list">
            {% for log in logs %}
                <li>{{ log }}</li>
            {% endfor %}
        </ul>
    </div>

    <!-- Status message -->
    <p id="log-status" style="margin-top: 20px; color: #0f0;"></p>
</div>
{% endblock %}

{% block scripts %}
<script>
function openLogFile() {
    fetch("/open-log", { method: "POST" })
        .then(res => res.json())
        .then(data => {
            const msg = document.getElementById("log-status");
            if (data.success) {
                msg.textContent = "Log file opened.";
                msg.style.color = "#0f0";
            } else {
                msg.textContent = "Error opening file: " + data.error;
                msg.style.color = "red";
            }
        })
        .catch(() => {
            const msg = document.getElementById("log-status");
            msg.textContent = "Network error ‚Äì could not contact server.";
            msg.style.color = "red";
        });
}
</script>
{% endblock %}
